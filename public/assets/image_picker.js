if(!this.JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(c){var a=c.scrollTo=function(d,f,g){c(window).scrollTo(d,f,g)};a.defaults={axis:"xy",duration:parseFloat(c.fn.jquery)>=1.3?0:1};a.window=function(d){return c(window)._scrollable()};c.fn._scrollable=function(){return this.map(function(){var d=this,f=!d.nodeName||c.inArray(d.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!f){return d}var g=(d.contentWindow||d).document||d.ownerDocument||d;return c.browser.safari||g.compatMode=="BackCompat"?g.body:g.documentElement})};c.fn.scrollTo=function(f,e,d){if(typeof e=="object"){d=e;e=0}if(typeof d=="function"){d={onAfter:d}}if(f=="max"){f=9000000000}d=c.extend({},a.defaults,d);e=e||d.speed||d.duration;d.queue=d.queue&&d.axis.length>1;if(d.queue){e/=2}d.offset=b(d.offset);d.over=b(d.over);return this._scrollable().each(function(){var n=this,l=c(n),m=f,j,k={},h=l.is("html,body");switch(typeof m){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(m)){m=b(m);break}m=c(m,this);case"object":if(m.is||m.style){j=(m=c(m)).offset()}}c.each(d.axis.split(""),function(q,r){var t=r=="x"?"Left":"Top",s=t.toLowerCase(),v="scroll"+t,p=n[v],g=a.max(n,r);if(j){k[v]=j[s]+(h?0:p-l.offset()[s]);if(d.margin){k[v]-=parseInt(m.css("margin"+t))||0;k[v]-=parseInt(m.css("border"+t+"Width"))||0}k[v]+=d.offset[s]||0;if(d.over[s]){k[v]+=m[r=="x"?"width":"height"]()*d.over[s]}}else{var u=m[s];k[v]=u.slice&&u.slice(-1)=="%"?parseFloat(u)/100*g:u}if(/^\d+$/.test(k[v])){k[v]=k[v]<=0?0:Math.min(k[v],g)}if(!q&&d.queue){if(p!=k[v]){i(d.onAfterFirst)}delete k[v]}});i(d.onAfter);function i(g){l.animate(k,e,d.easing,g&&function(){g.call(this,f,d)})}}).end()};a.max=function(g,j){var n=j=="x"?"Width":"Height",k="scroll"+n;if(!c(g).is("html,body")){return g[k]-c(g)[n.toLowerCase()]()}var o="client"+n,f=g.ownerDocument.documentElement,d=g.ownerDocument.body;return Math.max(f[k],d[k])-Math.min(f[o],d[o])};function b(d){return typeof d=="object"?d:{top:d,left:d}}})(jQuery);var CodeMirrorConfig=window.CodeMirrorConfig||{},CodeMirror=function(){function g(i,h){for(var j in h){i.hasOwnProperty(j)||(i[j]=h[j])}}function f(i,h){for(var j=0;j<i.length;j++){h(i[j])}}function d(h){return document.createElementNS&&document.documentElement.namespaceURI!==null?document.createElementNS("http://www.w3.org/1999/xhtml",h):document.createElement(h)}function e(j,i){var m=d("div"),l=d("div");m.style.position="absolute";m.style.height="100%";if(m.style.setExpression){try{m.style.setExpression("height","this.previousSibling.offsetHeight + 'px'")}catch(k){}}m.style.top="0px";m.style.left="0px";m.style.overflow="hidden";j.appendChild(m);l.className="CodeMirror-line-numbers";m.appendChild(l);l.innerHTML="<div>"+i+"</div>";return m}function c(i){if(typeof i.parserfile=="string"){i.parserfile=[i.parserfile]}if(typeof i.basefiles=="string"){i.basefiles=[i.basefiles]}if(typeof i.stylesheet=="string"){i.stylesheet=[i.stylesheet]}var h=['<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head>'];h.push('<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>');var j=i.noScriptCaching?"?nocache="+(new Date).getTime().toString(16):"";f(i.stylesheet,function(k){h.push('<link rel="stylesheet" type="text/css" href="'+k+j+'"/>')});f(i.basefiles.concat(i.parserfile),function(k){/^https?:/.test(k)||(k=i.path+k);h.push('<script type="text/javascript" src="'+k+j+'"><\/script>')});h.push('</head><body style="border-width: 0;" class="editbox" spellcheck="'+(i.disableSpellcheck?"false":"true")+'"></body></html>');return h.join("")}function b(j,i){this.options=i=i||{};g(i,CodeMirrorConfig);if(i.dumbTabs){i.tabMode="spaces"}else{if(i.normalTab){i.tabMode="default"}}if(i.cursorActivity){i.onCursorActivity=i.cursorActivity}var m=this.frame=d("iframe");if(i.iframeClass){m.className=i.iframeClass}m.frameBorder=0;m.style.border="0";m.style.width="100%";m.style.height="100%";m.style.display="block";var l=this.wrapping=d("div");l.style.position="relative";l.className="CodeMirror-wrapping";l.style.width=i.width;l.style.height=i.height=="dynamic"?i.minHeight+"px":i.height;var k=this.textareaHack=d("textarea");l.appendChild(k);k.style.position="absolute";k.style.left="-10000px";k.style.width="10px";k.tabIndex=100000;m.CodeMirror=this;if(i.domain&&a){this.html=c(i);m.src="javascript:(function(){document.open();"+(i.domain?'document.domain="'+i.domain+'";':"")+"document.write(window.frameElement.CodeMirror.html);document.close();})()"}else{m.src="javascript:;"}j.appendChild?j.appendChild(l):j(l);l.appendChild(m);if(i.lineNumbers){this.lineNumbers=e(l,i.firstLineNumber)}this.win=m.contentWindow;if(!i.domain||!a){this.win.document.open();this.win.document.write(c(i));this.win.document.close()}}g(CodeMirrorConfig,{stylesheet:[],path:"",parserfile:[],basefiles:["util.js","stringstream.js","select.js","undo.js","editor.js","tokenize.js"],iframeClass:null,passDelay:200,passTime:50,lineNumberDelay:200,lineNumberTime:50,continuousScanning:false,saveFunction:null,onLoad:null,onChange:null,undoDepth:50,undoDelay:800,disableSpellcheck:true,textWrapping:true,readOnly:false,width:"",height:"300px",minHeight:100,autoMatchParens:false,markParen:null,unmarkParen:null,parserConfig:null,tabMode:"indent",enterMode:"indent",electricChars:true,reindentOnLoad:false,activeTokens:null,onCursorActivity:null,lineNumbers:false,firstLineNumber:1,onLineNumberClick:null,indentUnit:2,domain:null,noScriptCaching:false,incrementalLoading:false});var a=document.selection&&window.ActiveXObject&&/MSIE/.test(navigator.userAgent);b.prototype={init:function(){this.options.initCallback&&this.options.initCallback(this);this.options.onLoad&&this.options.onLoad(this);this.options.lineNumbers&&this.activateLineNumbers();this.options.reindentOnLoad&&this.reindent();this.options.height=="dynamic"&&this.setDynamicHeight()},getCode:function(){return this.editor.getCode()},setCode:function(h){this.editor.importCode(h)},selection:function(){this.focusIfIE();return this.editor.selectedText()},reindent:function(){this.editor.reindent()},reindentSelection:function(){this.focusIfIE();this.editor.reindentSelection(null)},focusIfIE:function(){this.win.select.ie_selection&&document.activeElement!=this.frame&&this.focus()},focus:function(){this.win.focus();this.editor.selectionSnapshot&&this.win.select.setBookmark(this.win.document.body,this.editor.selectionSnapshot)},replaceSelection:function(h){this.focus();this.editor.replaceSelection(h);return true},replaceChars:function(i,h,j){this.editor.replaceChars(i,h,j)},getSearchCursor:function(i,h,j){return this.editor.getSearchCursor(i,h,j)},undo:function(){this.editor.history.undo()},redo:function(){this.editor.history.redo()},historySize:function(){return this.editor.history.historySize()},clearHistory:function(){this.editor.history.clear()},grabKeys:function(i,h){this.editor.grabKeys(i,h)},ungrabKeys:function(){this.editor.ungrabKeys()},setParser:function(i,h){this.editor.setParser(i,h)},setSpellcheck:function(h){this.win.document.body.spellcheck=h},setStylesheet:function(j){if(typeof j==="string"){j=[j]}for(var i={},q={},o=this.win.document.getElementsByTagName("link"),k=0,m;m=o[k];k++){if(m.rel.indexOf("stylesheet")!==-1){for(var l=0;l<j.length;l++){var p=j[l];if(m.href.substring(m.href.length-p.length)===p){i[m.href]=true;q[p]=true}}}}for(k=0;m=o[k];k++){if(m.rel.indexOf("stylesheet")!==-1){m.disabled=!(m.href in i)}}for(l=0;l<j.length;l++){p=j[l];if(!(p in q)){m=this.win.document.createElement("link");m.rel="stylesheet";m.type="text/css";m.href=p;this.win.document.getElementsByTagName("head")[0].appendChild(m)}}},setTextWrapping:function(h){if(h!=this.options.textWrapping){this.win.document.body.style.whiteSpace=h?"":"nowrap";this.options.textWrapping=h;if(this.lineNumbers){this.setLineNumbers(false);this.setLineNumbers(true)}}},setIndentUnit:function(h){this.win.indentUnit=h},setUndoDepth:function(h){this.editor.history.maxDepth=h},setTabMode:function(h){this.options.tabMode=h},setEnterMode:function(h){this.options.enterMode=h},setLineNumbers:function(h){if(h&&!this.lineNumbers){this.lineNumbers=e(this.wrapping,this.options.firstLineNumber);this.activateLineNumbers()}else{if(!h&&this.lineNumbers){this.wrapping.removeChild(this.lineNumbers);this.wrapping.style.paddingLeft="";this.lineNumbers=null}}},cursorPosition:function(h){this.focusIfIE();return this.editor.cursorPosition(h)},firstLine:function(){return this.editor.firstLine()},lastLine:function(){return this.editor.lastLine()},nextLine:function(h){return this.editor.nextLine(h)},prevLine:function(h){return this.editor.prevLine(h)},lineContent:function(h){return this.editor.lineContent(h)},setLineContent:function(i,h){this.editor.setLineContent(i,h)},removeLine:function(h){this.editor.removeLine(h)},insertIntoLine:function(i,h,j){this.editor.insertIntoLine(i,h,j)},selectLines:function(i,h,k,j){this.win.focus();this.editor.selectLines(i,h,k,j)},nthLine:function(i){for(var h=this.firstLine();i>1&&h!==false;i--){h=this.nextLine(h)}return h},lineNumber:function(i){for(var h=0;i!==false;){h++;i=this.prevLine(i)}return h},jumpToLine:function(h){if(typeof h=="number"){h=this.nthLine(h)}this.selectLines(h,0);this.win.focus()},currentLine:function(){return this.lineNumber(this.cursorLine())},cursorLine:function(){return this.cursorPosition().line},cursorCoords:function(h){return this.editor.cursorCoords(h)},activateLineNumbers:function(){function D(){if(u.offsetWidth!=0){for(var i=u;i.parentNode;i=i.parentNode){}if(!r.parentNode||i!=document||!t.Editor){try{A()}catch(h){}clearInterval(C)}else{if(r.offsetWidth!=w){w=r.offsetWidth;u.parentNode.style.paddingLeft=w+"px"}}}}function B(){r.scrollTop=k.scrollTop||m.documentElement.scrollTop||0}function x(j){var i=o.firstChild.offsetHeight;if(i!=0){i=Math.ceil((50+Math.max(k.offsetHeight,Math.max(u.offsetHeight,k.scrollHeight||0)))/i);for(var l=o.childNodes.length;l<=i;l++){var h=d("div");h.appendChild(document.createTextNode(j?String(l+p.options.firstLineNumber):"\u00a0"));o.appendChild(h)}}}function v(){function i(){x(true);B()}p.updateNumbers=i;var h=t.addEventHandler(t,"scroll",B,true),j=t.addEventHandler(t,"resize",i,true);A=function(){h();j();if(p.updateNumbers==i){p.updateNumbers=null}};i()}function s(){function y(K,I){h||(h=o.appendChild(d("div")));G&&G(h,I,K);M.push(h);M.push(K);j=h.offsetHeight+h.offsetTop;h=h.nextSibling}function q(){for(var I=0;I<M.length;I+=2){M[I].innerHTML=M[I+1]}M=[]}function l(){if(!(!o.parentNode||o.parentNode!=p.lineNumbers)){for(var K=(new Date).getTime()+p.options.lineNumberTime;n;){for(y(i++,n.previousSibling);n&&!t.isBR(n);n=n.nextSibling){for(var I=n.offsetTop+n.offsetHeight;o.offsetHeight&&I-3>j;){y("&nbsp;")}}if(n){n=n.nextSibling}if((new Date).getTime()>K){q();J=setTimeout(l,p.options.lineNumberDelay);return}}for(;h;){y(i++)}q();B()}}function H(I){B();x(I);n=k.firstChild;h=o.firstChild;j=0;i=p.options.firstLineNumber;l()}function F(){J&&clearTimeout(J);if(p.editor.allClean()){H()}else{J=setTimeout(F,200)}}var n,h,i,j,M=[],G=p.options.styleNumbers;H(true);var J=null;p.updateNumbers=F;var E=t.addEventHandler(t,"scroll",B,true),z=t.addEventHandler(t,"resize",F,true);A=function(){J&&clearTimeout(J);if(p.updateNumbers==F){p.updateNumbers=null}E();z()}}var u=this.frame,t=u.contentWindow,m=t.document,k=m.body,r=this.lineNumbers,o=r.firstChild,p=this,w=null;r.onclick=function(i){var h=p.options.onLineNumberClick;if(h){i=(i||window.event).target||(i||window.event).srcElement;var j=i==r?NaN:Number(i.innerHTML);isNaN(j)||h(j,i)}};var A=function(){};D();var C=setInterval(D,500);(this.options.textWrapping||this.options.styleNumbers?s:v)()},setDynamicHeight:function(){function j(){for(var r=0,n=k.lastChild,h;n&&o.isBR(n);){n.hackBR||r++;n=n.previousSibling}if(n){m=n.offsetHeight;h=n.offsetTop+(1+r)*m}else{if(m){h=r*m}}if(h){i.wrapping.style.height=Math.max(p+h,i.options.minHeight)+"px"}}var i=this,q=i.options.onCursorActivity,o=i.win,k=o.document.body,m=null,l=null,p=2*i.frame.offsetTop;k.style.overflowY="hidden";o.document.documentElement.style.overflowY="hidden";this.frame.scrolling="no";setTimeout(j,300);i.options.onCursorActivity=function(h){q&&q(h);clearTimeout(l);l=setTimeout(j,100)}}};b.InvalidLineHandle={toString:function(){return"CodeMirror.InvalidLineHandle"}};b.replace=function(h){if(typeof h=="string"){h=document.getElementById(h)}return function(i){h.parentNode.replaceChild(i,h)}};b.fromTextArea=function(j,i){function n(){j.value=l.getCode()}if(typeof j=="string"){j=document.getElementById(j)}i=i||{};if(j.style.width&&i.width==null){i.width=j.style.width}if(j.style.height&&i.height==null){i.height=j.style.height}if(i.content==null){i.content=j.value}if(j.form){typeof j.form.addEventListener=="function"?j.form.addEventListener("submit",n,false):j.form.attachEvent("onsubmit",n);var m=j.form.submit,k=function(){n();j.form.submit=m;j.form.submit();j.form.submit=k};j.form.submit=k}j.style.display="none";var l=new b(function(h){j.nextSibling?j.parentNode.insertBefore(h,j.nextSibling):j.parentNode.appendChild(h)},i);l.save=n;l.toTextArea=function(){n();j.parentNode.removeChild(l.wrapping);j.style.display="";if(j.form){j.form.submit=m;typeof j.form.removeEventListener=="function"?j.form.removeEventListener("submit",n,false):j.form.detachEvent("onsubmit",n)}};return l};b.isProbablySupported=function(){var h;return window.opera?Number(window.opera.version())>=9.52:/Apple Computer, Inc/.test(navigator.vendor)&&(h=navigator.userAgent.match(/Version\/(\d+(?:\.\d+)?)\./))?Number(h[1])>=3:document.selection&&window.ActiveXObject&&(h=navigator.userAgent.match(/MSIE (\d+(?:\.\d*)?)\b/))?Number(h[1])>=6:(h=navigator.userAgent.match(/gecko\/(\d{8})/i))?Number(h[1])>=20050901:(h=navigator.userAgent.match(/AppleWebKit\/(\d+)/))?Number(h[1])>=525:null};return b}();(function(A){var J,S,Q,K,d,w,I,N,z,D=0,H={},h=[],e=0,F={},y=[],f=null,m=new Image(),g=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,k=/[^\.]\.(swf)\s*$/i,q,L=1,a,c,O=false,C=20,t=A.extend(A("<div/>")[0],{prop:0}),j=0,R=!A.support.opacity&&!window.XMLHttpRequest,i=function(){S.hide();m.onerror=m.onload=null;if(f){f.abort()}J.empty()},p=function(){A.fancybox('<p id="fancybox_error">The requested content cannot be loaded.<br />Please try again later.</p>',{scrolling:"no",padding:20,transitionIn:"none",transitionOut:"none"})},E=function(){return[A(window).width(),A(window).height(),A(document).scrollLeft(),A(document).scrollTop()]},b=function(){var V=E(),ac={},aa=F.margin,W=F.autoScale,ab=(C+aa)*2,Z=(C+aa)*2,X=(F.padding*2),Y;if(F.width.toString().indexOf("%")>-1){ac.width=((V[0]*parseFloat(F.width))/100)-(C*2);W=false}else{ac.width=F.width+X}if(F.height.toString().indexOf("%")>-1){ac.height=((V[1]*parseFloat(F.height))/100)-(C*2);W=false}else{ac.height=F.height+X}if(W&&(ac.width>(V[0]-ab)||ac.height>(V[1]-Z))){if(H.type=="image"||H.type=="swf"){ab+=X;Z+=X;Y=Math.min(Math.min(V[0]-ab,F.width)/F.width,Math.min(V[1]-Z,F.height)/F.height);ac.width=Math.round(Y*(ac.width-X))+X;ac.height=Math.round(Y*(ac.height-X))+X}else{ac.width=Math.min(ac.width,(V[0]-ab));ac.height=Math.min(ac.height,(V[1]-Z))}}ac.top=V[3]+((V[1]-(ac.height+(C*2)))*0.5);ac.left=V[2]+((V[0]-(ac.width+(C*2)))*0.5);if(F.autoScale===false){ac.top=Math.max(V[3]+aa,ac.top);ac.left=Math.max(V[2]+aa,ac.left)}return ac},M=function(V){if(V&&V.length){switch(F.titlePosition){case"inside":return V;case"over":return'<span id="fancybox-title-over">'+V+"</span>";default:return'<span id="fancybox-title-wrap"><span id="fancybox-title-left"></span><span id="fancybox-title-main">'+V+'</span><span id="fancybox-title-right"></span></span>'}}return false},s=function(){var X=F.title,W=c.width-(F.padding*2),V="fancybox-title-"+F.titlePosition;A("#fancybox-title").remove();j=0;if(F.titleShow===false){return}X=A.isFunction(F.titleFormat)?F.titleFormat(X,y,e,F):M(X);if(!X||X===""){return}A('<div id="fancybox-title" class="'+V+'" />').css({width:W,paddingLeft:F.padding,paddingRight:F.padding}).html(X).appendTo("body");switch(F.titlePosition){case"inside":j=A("#fancybox-title").outerHeight(true)-F.padding;c.height+=j;break;case"over":A("#fancybox-title").css("bottom",F.padding);break;default:A("#fancybox-title").css("bottom",A("#fancybox-title").outerHeight(true)*-1);break}A("#fancybox-title").appendTo(d).hide()},o=function(){A(document).unbind("keydown.fb").bind("keydown.fb",function(V){if(V.keyCode==27&&F.enableEscapeButton){V.preventDefault();A.fancybox.close()}else{if(V.keyCode==37){V.preventDefault();A.fancybox.prev()}else{if(V.keyCode==39){V.preventDefault();A.fancybox.next()}}}});if(A.fn.mousewheel){K.unbind("mousewheel.fb");if(y.length>1){K.bind("mousewheel.fb",function(V,W){V.preventDefault();if(O||W===0){return}if(W>0){A.fancybox.prev()}else{A.fancybox.next()}})}}if(!F.showNavArrows){return}if((F.cyclic&&y.length>1)||e!==0){N.show()}if((F.cyclic&&y.length>1)||e!=(y.length-1)){z.show()}},T=function(){var V,W;if((y.length-1)>e){V=y[e+1].href;if(typeof V!=="undefined"&&V.match(g)){W=new Image();W.src=V}}if(e>0){V=y[e-1].href;if(typeof V!=="undefined"&&V.match(g)){W=new Image();W.src=V}}},v=function(){w.css("overflow",(F.scrolling=="auto"?(F.type=="image"||F.type=="iframe"||F.type=="swf"?"hidden":"auto"):(F.scrolling=="yes"?"auto":"visible")));if(!A.support.opacity){w.get(0).style.removeAttribute("filter");K.get(0).style.removeAttribute("filter")}A("#fancybox-title").show();if(F.hideOnContentClick){w.one("click",A.fancybox.close)}if(F.hideOnOverlayClick){Q.one("click",A.fancybox.close)}if(F.showCloseButton){I.show()}o();A(window).bind("resize.fb",A.fancybox.center);if(F.centerOnScroll){A(window).bind("scroll.fb",A.fancybox.center)}else{A(window).unbind("scroll.fb")}if(A.isFunction(F.onComplete)){F.onComplete(y,e,F)}O=false;T()},G=function(Z){var W=Math.round(a.width+(c.width-a.width)*Z),V=Math.round(a.height+(c.height-a.height)*Z),Y=Math.round(a.top+(c.top-a.top)*Z),X=Math.round(a.left+(c.left-a.left)*Z);K.css({width:W+"px",height:V+"px",top:Y+"px",left:X+"px"});W=Math.max(W-F.padding*2,0);V=Math.max(V-(F.padding*2+(j*Z)),0);w.css({width:W+"px",height:V+"px"});if(typeof c.opacity!=="undefined"){K.css("opacity",(Z<0.5?0.5:Z))}},x=function(V){var W=V.offset();W.top+=parseFloat(V.css("paddingTop"))||0;W.left+=parseFloat(V.css("paddingLeft"))||0;W.top+=parseFloat(V.css("border-top-width"))||0;W.left+=parseFloat(V.css("border-left-width"))||0;W.width=V.width();W.height=V.height();return W},U=function(){var Y=H.orig?A(H.orig):false,X={},W,V;if(Y&&Y.length){W=x(Y);X={width:(W.width+(F.padding*2)),height:(W.height+(F.padding*2)),top:(W.top-F.padding-C),left:(W.left-F.padding-C)}}else{V=E();X={width:1,height:1,top:V[3]+V[1]*0.5,left:V[2]+V[0]*0.5}}return X},u=function(){S.hide();if(K.is(":visible")&&A.isFunction(F.onCleanup)){if(F.onCleanup(y,e,F)===false){A.event.trigger("fancybox-cancel");O=false;return}}y=h;e=D;F=H;w.get(0).scrollTop=0;w.get(0).scrollLeft=0;if(F.overlayShow){if(R){A("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"})}Q.css({"background-color":F.overlayColor,opacity:F.overlayOpacity}).unbind().show()}c=b();s();if(K.is(":visible")){A(I.add(N).add(z)).hide();var W=K.position(),V;a={top:W.top,left:W.left,width:K.width(),height:K.height()};V=(a.width==c.width&&a.height==c.height);w.fadeOut(F.changeFade,function(){var X=function(){w.html(J.contents()).fadeIn(F.changeFade,v)};A.event.trigger("fancybox-change");w.empty().css("overflow","hidden");if(V){w.css({top:F.padding,left:F.padding,width:Math.max(c.width-(F.padding*2),1),height:Math.max(c.height-(F.padding*2)-j,1)});X()}else{w.css({top:F.padding,left:F.padding,width:Math.max(a.width-(F.padding*2),1),height:Math.max(a.height-(F.padding*2),1)});t.prop=0;A(t).animate({prop:1},{duration:F.changeSpeed,easing:F.easingChange,step:G,complete:X})}});return}K.css("opacity",1);if(F.transitionIn=="elastic"){a=U();w.css({top:F.padding,left:F.padding,width:Math.max(a.width-(F.padding*2),1),height:Math.max(a.height-(F.padding*2),1)}).html(J.contents());K.css(a).show();if(F.opacity){c.opacity=0}t.prop=0;A(t).animate({prop:1},{duration:F.speedIn,easing:F.easingIn,step:G,complete:v})}else{w.css({top:F.padding,left:F.padding,width:Math.max(c.width-(F.padding*2),1),height:Math.max(c.height-(F.padding*2)-j,1)}).html(J.contents());K.css(c).fadeIn(F.transitionIn=="none"?0:F.speedIn,v)}},r=function(){J.width(H.width);J.height(H.height);if(H.width=="auto"){H.width=J.width()}if(H.height=="auto"){H.height=J.height()}u()},P=function(){O=true;H.width=m.width;H.height=m.height;A("<img />").attr({id:"fancybox-img",src:m.src,alt:H.title}).appendTo(J);u()},l=function(){i();var aa=h[D],X,Y,ac,ab,W,V,Z;H=A.extend({},A.fn.fancybox.defaults,(typeof A(aa).data("fancybox")=="undefined"?H:A(aa).data("fancybox")));ac=aa.title||A(aa).title||H.title||"";if(aa.nodeName&&!H.orig){H.orig=A(aa).children("img:first").length?A(aa).children("img:first"):A(aa)}if(ac===""&&H.orig){ac=H.orig.attr("alt")}if(aa.nodeName&&(/^(?:javascript|#)/i).test(aa.href)){X=H.href||null}else{X=H.href||aa.href||null}if(H.type){Y=H.type;if(!X){X=H.content}}else{if(H.content){Y="html"}else{if(X){if(X.match(g)){Y="image"}else{if(X.match(k)){Y="swf"}else{if(A(aa).hasClass("iframe")){Y="iframe"}else{if(X.match(/#/)){aa=X.substr(X.indexOf("#"));Y=A(aa).length>0?"inline":"ajax"}else{Y="ajax"}}}}}else{Y="inline"}}}H.type=Y;H.href=X;H.title=ac;if(H.autoDimensions&&H.type!=="iframe"&&H.type!=="swf"){H.width="auto";H.height="auto"}if(H.modal){H.overlayShow=true;H.hideOnOverlayClick=false;H.hideOnContentClick=false;H.enableEscapeButton=false;H.showCloseButton=false}if(A.isFunction(H.onStart)){if(H.onStart(h,D,H)===false){O=false;return}}J.css("padding",(C+H.padding+H.margin));A(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){A(this).replaceWith(w.children())});switch(Y){case"html":J.html(H.content);r();break;case"inline":A('<div class="fancybox-inline-tmp" />').hide().insertBefore(A(aa)).bind("fancybox-cleanup",function(){A(this).replaceWith(w.children())}).bind("fancybox-cancel",function(){A(this).replaceWith(J.children())});A(aa).appendTo(J);r();break;case"image":O=false;A.fancybox.showActivity();m=new Image();m.onerror=function(){p()};m.onload=function(){m.onerror=null;m.onload=null;P()};m.src=X;break;case"swf":ab='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+H.width+'" height="'+H.height+'"><param name="movie" value="'+X+'"></param>';W="";A.each(H.swf,function(ad,ae){ab+='<param name="'+ad+'" value="'+ae+'"></param>';W+=" "+ad+'="'+ae+'"'});ab+='<embed src="'+X+'" type="application/x-shockwave-flash" width="'+H.width+'" height="'+H.height+'"'+W+"></embed></object>";J.html(ab);r();break;case"ajax":V=X.split("#",2);Z=H.ajax.data||{};if(V.length>1){X=V[0];if(typeof Z=="string"){Z+="&selector="+V[1]}else{Z.selector=V[1]}}O=false;A.fancybox.showActivity();f=A.ajax(A.extend(H.ajax,{url:X,data:Z,error:p,success:function(ae,af,ad){if(f.status==200){J.html(ae);r()}}}));break;case"iframe":A('<iframe id="fancybox-frame" name="fancybox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" scrolling="'+H.scrolling+'" src="'+H.href+'"></iframe>').appendTo(J);u();break}},n=function(){if(!S.is(":visible")){clearInterval(q);return}A("div",S).css("top",(L*-40)+"px");L=(L+1)%12},B=function(){if(A("#fancybox-wrap").length){return}A("body").append(J=A('<div id="fancybox-tmp"></div>'),S=A('<div id="fancybox-loading"><div></div></div>'),Q=A('<div id="fancybox-overlay"></div>'),K=A('<div id="fancybox-wrap"></div>'));if(!A.support.opacity){K.addClass("fancybox-ie");S.addClass("fancybox-ie")}d=A('<div id="fancybox-outer"></div>').append('<div class="fancy-bg" id="fancy-bg-n"></div><div class="fancy-bg" id="fancy-bg-ne"></div><div class="fancy-bg" id="fancy-bg-e"></div><div class="fancy-bg" id="fancy-bg-se"></div><div class="fancy-bg" id="fancy-bg-s"></div><div class="fancy-bg" id="fancy-bg-sw"></div><div class="fancy-bg" id="fancy-bg-w"></div><div class="fancy-bg" id="fancy-bg-nw"></div>').appendTo(K);d.append(w=A('<div id="fancybox-inner"></div>'),I=A('<a id="fancybox-close"></a>'),N=A('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),z=A('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));I.click(A.fancybox.close);S.click(A.fancybox.cancel);N.click(function(V){V.preventDefault();A.fancybox.prev()});z.click(function(V){V.preventDefault();A.fancybox.next()});if(R){Q.get(0).style.setExpression("height","document.body.scrollHeight > document.body.offsetHeight ? document.body.scrollHeight : document.body.offsetHeight + 'px'");S.get(0).style.setExpression("top","(-20 + (document.documentElement.clientHeight ? document.documentElement.clientHeight/2 : document.body.clientHeight/2 ) + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop )) + 'px'");d.prepend('<iframe id="fancybox-hide-sel-frame" src="javascript:\'\';" scrolling="no" frameborder="0" ></iframe>')}};A.fn.fancybox=function(V){A(this).data("fancybox",A.extend({},V,(A.metadata?A(this).metadata():{}))).unbind("click.fb").bind("click.fb",function(X){X.preventDefault();if(O){return}O=true;A(this).blur();h=[];D=0;var W=A(this).attr("rel")||"";if(!W||W==""||W==="nofollow"){h.push(this)}else{h=A("a[rel="+W+"], area[rel="+W+"]");D=h.index(this)}l();return false});return this};A.fancybox=function(Y){if(O){return}O=true;var X=typeof arguments[1]!=="undefined"?arguments[1]:{};h=[];D=X.index||0;if(A.isArray(Y)){for(var W=0,V=Y.length;W<V;W++){if(typeof Y[W]=="object"){A(Y[W]).data("fancybox",A.extend({},X,Y[W]))}else{Y[W]=A({}).data("fancybox",A.extend({content:Y[W]},X))}}h=jQuery.merge(h,Y)}else{if(typeof Y=="object"){A(Y).data("fancybox",A.extend({},X,Y))}else{Y=A({}).data("fancybox",A.extend({content:Y},X))}h.push(Y)}if(D>h.length||D<0){D=0}l()};A.fancybox.showActivity=function(){clearInterval(q);S.show();q=setInterval(n,66)};A.fancybox.hideActivity=function(){S.hide()};A.fancybox.next=function(){return A.fancybox.pos(e+1)};A.fancybox.prev=function(){return A.fancybox.pos(e-1)};A.fancybox.pos=function(V){if(O){return}V=parseInt(V,10);if(V>-1&&y.length>V){D=V;l()}if(F.cyclic&&y.length>1&&V<0){D=y.length-1;l()}if(F.cyclic&&y.length>1&&V>=y.length){D=0;l()}return};A.fancybox.cancel=function(){if(O){return}O=true;A.event.trigger("fancybox-cancel");i();if(H&&A.isFunction(H.onCancel)){H.onCancel(h,D,H)}O=false};A.fancybox.close=function(){if(O||K.is(":hidden")){return}O=true;if(F&&A.isFunction(F.onCleanup)){if(F.onCleanup(y,e,F)===false){O=false;return}}i();A(I.add(N).add(z)).hide();A("#fancybox-title").remove();K.add(w).add(Q).unbind();A(window).unbind("resize.fb scroll.fb");A(document).unbind("keydown.fb");function V(){Q.fadeOut("fast");K.hide();A.event.trigger("fancybox-cleanup");w.empty();if(A.isFunction(F.onClosed)){F.onClosed(y,e,F)}y=H=[];e=D=0;F=H={};O=false}w.css("overflow","hidden");if(F.transitionOut=="elastic"){a=U();var W=K.position();c={top:W.top,left:W.left,width:K.width(),height:K.height()};if(F.opacity){c.opacity=1}t.prop=1;A(t).animate({prop:0},{duration:F.speedOut,easing:F.easingOut,step:G,complete:V})}else{K.fadeOut(F.transitionOut=="none"?0:F.speedOut,V)}};A.fancybox.resize=function(){var W,V;if(O||K.is(":hidden")){return}O=true;W=w.wrapInner("<div style='overflow:auto'></div>").children();V=W.height();K.css({height:V+(F.padding*2)+j});w.css({height:V});W.replaceWith(W.children());A.fancybox.center()};A.fancybox.center=function(){O=true;var V=E(),W=F.margin,X={};X.top=V[3]+((V[1]-((K.height()-j)+(C*2)))*0.5);X.left=V[2]+((V[0]-(K.width()+(C*2)))*0.5);X.top=Math.max(V[3]+W,X.top);X.left=Math.max(V[2]+W,X.left);K.css(X);O=false};A.fn.fancybox.defaults={padding:10,margin:20,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.3,overlayColor:"#666",titleShow:true,titlePosition:"outside",titleFormat:null,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,onStart:null,onCancel:null,onComplete:null,onCleanup:null,onClosed:null};A(document).ready(function(){B()})})(jQuery);(function(){var r=0,m=[],k={},o={},t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},l=/[<>&\"\']/g,s;function p(){this.returnValue=false}function n(){this.cancelBubble=true}(function(c){var b=c.split(/,/),a,d,e;for(a=0;a<b.length;a+=2){e=b[a+1].split(/ /);for(d=0;d<e.length;d++){o[e[d]]=b[a]}}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats,docx pptx xlsx,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/x-flv,flv,video/vnd.rn-realvideo,rv,text/plain,asc txt text diff log,application/octet-stream,exe");var q={STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-700,mimeTypes:o,extend:function(a){q.each(arguments,function(c,b){if(b>0){q.each(c,function(d,e){a[e]=d})}});return a},cleanName:function(c){var b,a;a=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<a.length;b+=2){c=c.replace(a[b],a[b+1])}c=c.replace(/\s+/g,"_");c=c.replace(/[^a-z0-9_\-\.]+/gi,"");return c},addRuntime:function(b,a){a.name=b;m[b]=a;m.push(a);return a},guid:function(){var b=new Date().getTime().toString(32),a;for(a=0;a<5;a++){b+=Math.floor(Math.random()*65535).toString(32)}return(q.guidPrefix||"p")+b+(r++).toString(32)},buildUrl:function(b,c){var a="";q.each(c,function(d,e){a+=(a?"&":"")+encodeURIComponent(e)+"="+encodeURIComponent(d)});if(a){b+=(b.indexOf("?")>0?"&":"?")+a}return b},each:function(e,d){var a,b,c;if(e){a=e.length;if(a===s){for(b in e){if(e.hasOwnProperty(b)){if(d(e[b],b)===false){return}}}}else{for(c=0;c<a;c++){if(d(e[c],c)===false){return}}}}},formatSize:function(a){if(a===s){return q.translate("N/A")}if(a>1048576){return Math.round(a/1048576,1)+" MB"}if(a>1024){return Math.round(a/1024,1)+" KB"}return a+" b"},getPos:function(g,c){var b=0,d=0,i,a=document,f,e;g=g;c=c||a.body;function h(j){var y,x,A=0,B=0;if(j){x=j.getBoundingClientRect();y=a.compatMode==="CSS1Compat"?a.documentElement:a.body;A=x.left+y.scrollLeft;B=x.top+y.scrollTop}return{x:A,y:B}}if(g.getBoundingClientRect&&(navigator.userAgent.indexOf("MSIE")>0&&a.documentMode!==8)){f=h(g);e=h(c);return{x:f.x-e.x,y:f.y-e.y}}i=g;while(i&&i!=c&&i.nodeType){b+=i.offsetLeft||0;d+=i.offsetTop||0;i=i.offsetParent}i=g.parentNode;while(i&&i!=c&&i.nodeType){b-=i.scrollLeft||0;d-=i.scrollTop||0;i=i.parentNode}return{x:b,y:d}},getSize:function(a){return{w:a.clientWidth||a.offsetWidth,h:a.clientHeight||a.offsetHeight}},parseSize:function(b){var a;if(typeof(b)=="string"){b=/^([0-9]+)([mgk]+)$/.exec(b.toLowerCase().replace(/[^0-9mkg]/g,""));a=b[2];b=+b[1];if(a=="g"){b*=1073741824}if(a=="m"){b*=1048576}if(a=="k"){b*=1024}}return b},xmlEncode:function(a){return a?(""+a).replace(l,function(b){return t[b]?"&"+t[b]+";":b}):a},toArray:function(a){var b,c=[];for(b=0;b<a.length;b++){c[b]=a[b]}return c},addI18n:function(a){return q.extend(k,a)},translate:function(a){return k[a]||a},addEvent:function(b,c,a){if(b.attachEvent){b.attachEvent("on"+c,function(){var d=window.event;if(!d.target){d.target=d.srcElement}d.preventDefault=p;d.stopPropagation=n;a(d)})}else{if(b.addEventListener){b.addEventListener(c,a,false)}}}};q.Uploader=function(h){var b={},e,f=[],d,a;e=new q.QueueProgress();h=q.extend({chunk_size:0,max_file_size:"1gb",multi_selection:true,file_data_name:"file",filters:[]},h);function g(){var i;if(this.state==q.STARTED&&d<f.length){i=f[d++];if(i.status==q.QUEUED){this.trigger("UploadFile",i)}else{g.call(this)}}else{this.stop()}}function c(){var i,j;e.reset();for(i=0;i<f.length;i++){j=f[i];if(j.size!==s){e.size+=j.size;e.loaded+=j.loaded}else{e.size=s}if(j.status==q.DONE){e.uploaded++}else{if(j.status==q.FAILED){e.failed++}else{e.queued++}}}if(e.size===s){e.percent=f.length>0?Math.ceil(e.uploaded/f.length*100):0}else{e.bytesPerSec=Math.ceil(e.loaded/((+new Date()-a||1)/1000));e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):0}}q.extend(this,{state:q.STOPPED,features:{},files:f,settings:h,total:e,id:q.guid(),init:function(){var i=this,D,A,B,j=0,z;h.page_url=h.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");if(!/^(\w+:\/\/|\/)/.test(h.url)){h.url=h.page_url+h.url}h.chunk_size=q.parseSize(h.chunk_size);h.max_file_size=q.parseSize(h.max_file_size);i.bind("FilesAdded",function(G,y){var H,u,v=0,w,x=h.filters;if(x&&x.length){w={};q.each(x,function(E){q.each(E.extensions.split(/,/),function(F){w[F.toLowerCase()]=true})})}for(H=0;H<y.length;H++){u=y[H];u.loaded=0;u.percent=0;u.status=q.QUEUED;if(w&&!w[u.name.toLowerCase().split(".").slice(-1)]){G.trigger("Error",{code:q.FILE_EXTENSION_ERROR,message:"File extension error.",file:u});continue}if(u.size!==s&&u.size>h.max_file_size){G.trigger("Error",{code:q.FILE_SIZE_ERROR,message:"File size error.",file:u});continue}f.push(u);v++}if(v){i.trigger("QueueChanged");i.refresh()}});if(h.unique_names){i.bind("UploadFile",function(v,u){u.target_name=u.id+".tmp"})}i.bind("UploadProgress",function(v,u){if(u.status==q.QUEUED){u.status=q.UPLOADING}u.percent=u.size>0?Math.ceil(u.loaded/u.size*100):100;c()});i.bind("StateChanged",function(u){if(u.state==q.STARTED){a=(+new Date())}});i.bind("QueueChanged",c);i.bind("Error",function(v,u){if(u.file){u.file.status=q.FAILED;c();window.setTimeout(function(){g.call(i)})}});i.bind("FileUploaded",function(v,u){u.status=q.DONE;v.trigger("UploadProgress",u);g.call(i)});if(h.runtimes){A=[];z=h.runtimes.split(/\s?,\s?/);for(D=0;D<z.length;D++){if(m[z[D]]){A.push(m[z[D]])}}}else{A=m}function C(){var w=A[j++],x,v,u;if(w){x=w.getFeatures();v=i.settings.required_features;if(v){v=v.split(",");for(u=0;u<v.length;u++){if(!x[v[u]]){C();return}}}w.init(i,function(y){if(y&&y.success){i.features=x;i.trigger("Init",{runtime:w.name});i.trigger("PostInit");i.refresh()}else{C()}})}else{i.trigger("Error",{code:q.INIT_ERROR,message:"Init error."})}}C()},refresh:function(){this.trigger("Refresh")},start:function(){if(this.state!=q.STARTED){d=0;this.state=q.STARTED;this.trigger("StateChanged");g.call(this)}},stop:function(){if(this.state!=q.STOPPED){this.state=q.STOPPED;this.trigger("StateChanged")}},getFile:function(i){var j;for(j=f.length-1;j>=0;j--){if(f[j].id===i){return f[j]}}},removeFile:function(i){var j;for(j=f.length-1;j>=0;j--){if(f[j].id===i.id){return this.splice(j,1)[0]}}},splice:function(i,v){var j;j=f.splice(i,v);this.trigger("FilesRemoved",j);this.trigger("QueueChanged");return j},trigger:function(w){var i=b[w.toLowerCase()],j,x;if(i){x=Array.prototype.slice.call(arguments);x[0]=this;for(j=0;j<i.length;j++){if(i[j].func.apply(i[j].scope,x)===false){return false}}}return true},bind:function(x,j,w){var i;x=x.toLowerCase();i=b[x]||[];i.push({func:j,scope:w||this});b[x]=i},unbind:function(x,j){var i=b[x.toLowerCase()],w;if(i){for(w=i.length-1;w>=0;w--){if(i[w].func===j){i.splice(w,1)}}}}})};q.File=function(d,b,a){var c=this;c.id=d;c.name=b;c.size=a;c.loaded=0;c.percent=0;c.status=0};q.Runtime=function(){this.getFeatures=function(){};this.init=function(b,a){}};q.QueueProgress=function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}};q.runtimes={};window.plupload=q})();(function(d){var f={};function e(m,q,b,c,r){var a,o,p,n;o=google.gears.factory.create("beta.canvas");o.decode(m);n=Math.min(q/o.width,b/o.height);if(n<1){q=Math.round(o.width*n);b=Math.round(o.height*n)}else{q=o.width;b=o.height}o.resize(q,b);return o.encode(r,{quality:c/100})}d.runtimes.Gears=d.addRuntime("gears",{getFeatures:function(){return{dragdrop:true,jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(c,a){var b;if(!window.google||!google.gears){return a({success:false})}try{b=google.gears.factory.create("beta.desktop")}catch(j){return a({success:false})}function k(i){var n,o,h=[],g;for(o=0;o<i.length;o++){n=i[o];g=d.guid();f[g]=n.blob;h.push(new d.File(g,n.name,n.blob.length))}c.trigger("FilesAdded",h)}c.bind("PostInit",function(){var g=c.settings,h=document.getElementById(g.drop_element);if(h){d.addEvent(h,"dragover",function(i){b.setDropEffect(i,"copy");i.preventDefault()});d.addEvent(h,"drop",function(i){var m=b.getDragData(i,"application/x-gears-files");if(m){k(m.files)}i.preventDefault()});h=0}d.addEvent(document.getElementById(g.browse_button),"click",function(r){var s=[],p,q,i;r.preventDefault();for(p=0;p<g.filters.length;p++){i=g.filters[p].extensions.split(",");for(q=0;q<i.length;q++){s.push("."+i[q])}}b.openFiles(k,{singleFile:!g.multi_selection,filter:s})})});c.bind("UploadFile",function(i,t){var g=0,h,s,r=0,u=i.settings.resize,w;s=i.settings.chunk_size;w=s>0;h=Math.ceil(t.size/s);if(!w){s=t.size;h=1}if(u&&/\.(png|jpg|jpeg)$/i.test(t.name)){f[t.id]=e(f[t.id],u.width,u.height,u.quality||90,/\.png$/i.test(t.name)?"image/png":"image/jpeg")}t.size=f[t.id].length;function v(){var n,l,p=i.settings.multipart,q=0,m={name:t.target_name||t.name};function o(I){var E,G="----pluploadboundary"+d.guid(),D="--",H="\r\n",F;if(p){n.setRequestHeader("Content-Type","multipart/form-data; boundary="+G);E=google.gears.factory.create("beta.blobbuilder");d.each(i.settings.multipart_params,function(x,y){E.append(D+G+H+'Content-Disposition: form-data; name="'+y+'"'+H+H);E.append(x+H)});E.append(D+G+H+'Content-Disposition: form-data; name="'+i.settings.file_data_name+'"; filename="'+t.name+'"'+H+"Content-Type: application/octet-stream"+H+H);E.append(I);E.append(H+D+G+D+H);F=E.getAsBlob();q=F.length-I.length;I=F}n.send(I)}if(t.status==d.DONE||t.status==d.FAILED||i.state==d.STOPPED){return}if(w){m.chunk=g;m.chunks=h}l=Math.min(s,t.size-(g*s));n=google.gears.factory.create("beta.httprequest");n.open("POST",d.buildUrl(i.settings.url,m));if(!p){n.setRequestHeader("Content-Disposition",'attachment; filename="'+t.name+'"');n.setRequestHeader("Content-Type","application/octet-stream")}d.each(i.settings.headers,function(A,z){n.setRequestHeader(z,A)});n.upload.onprogress=function(y){t.loaded=r+y.loaded-q;i.trigger("UploadProgress",t)};n.onreadystatechange=function(){var y;if(n.readyState==4){if(n.status==200){y={chunk:g,chunks:h,response:n.responseText,status:n.status};i.trigger("ChunkUploaded",t,y);if(y.cancelled){t.status=d.FAILED;return}r+=l;if(++g>=h){t.status=d.DONE;i.trigger("FileUploaded",t,{response:n.responseText,status:n.status})}else{v()}}else{i.trigger("Error",{code:d.HTTP_ERROR,message:"HTTP Error.",file:t,chunk:g,chunks:h,status:n.status})}}};if(g<h){o(f[t.id].slice(g*s,l))}}v()});a({success:true})}})})(plupload);(function(h){var f={};function e(a){var b,c=typeof a,d,n,i,m;if(c==="string"){b="\bb\tt\nn\ff\rr\"\"''\\\\";return'"'+a.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(l,j){var k=b.indexOf(j);if(k+1){return"\\"+b.charAt(k+1)}l=j.charCodeAt().toString(16);return"\\u"+"0000".substring(l.length)+l})+'"'}if(c=="object"){n=a.length!==d;b="";if(n){for(i=0;i<a.length;i++){if(b){b+=","}b+=e(a[i])}b="["+b+"]"}else{for(m in a){if(a.hasOwnProperty(m)){if(b){b+=","}b+=e(m)+":"+e(a[m])}}b="{"+b+"}"}return b}if(a===d){return"null"}return""+a}function g(d){var a=false,A=null,v=null,z,y,x,b,w,t=0;try{try{v=new ActiveXObject("AgControl.AgControl");if(v.IsVersionSupported(d)){a=true}v=null}catch(s){var u=navigator.plugins["Silverlight Plug-In"];if(u){z=u.description;if(z==="1.0.30226.2"){z="2.0.30226.2"}y=z.split(".");while(y.length>3){y.pop()}while(y.length<4){y.push(0)}x=d.split(".");while(x.length>4){x.pop()}do{b=parseInt(x[t],10);w=parseInt(y[t],10);t++}while(t<x.length&&b===w);if(b<=w&&!isNaN(b)){a=true}}}}catch(c){a=false}return a}h.silverlight={trigger:function(a,d){var b=f[a],c,i;if(b){i=h.toArray(arguments).slice(1);i[0]="Silverlight:"+d;setTimeout(function(){b.trigger.apply(b,i)},0)}}};h.runtimes.Silverlight=h.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(b,a){var c,i="",d=b.settings.filters,n,o=document.body;if(!g("2.0.31005.0")||(window.opera&&window.opera.buildNumber)){a({success:false});return}f[b.id]=b;c=document.createElement("div");c.id=b.id+"_silverlight_container";h.extend(c.style,{position:"absolute",top:"0px",background:b.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:b.settings.shim_bgcolor?"":0.01});c.className="plupload silverlight";if(b.settings.container){o=document.getElementById(b.settings.container);o.style.position="relative"}o.appendChild(c);for(n=0;n<d.length;n++){i+=(i!=""?"|":"")+d[n].title+" | *."+d[n].extensions.replace(/,/g,";*.")}c.innerHTML='<object id="'+b.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+b.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="initParams" value="id='+b.id+",filter="+i+'"/></object>';function p(){return document.getElementById(b.id+"_silverlight").content.Upload}b.bind("Silverlight:Init",function(){var j,k={};b.bind("Silverlight:StartSelectFiles",function(l){j=[]});b.bind("Silverlight:SelectFile",function(v,m,u,t){var l;l=h.guid();k[l]=m;k[m]=l;j.push(new h.File(l,u,t))});b.bind("Silverlight:SelectSuccessful",function(){if(j.length){b.trigger("FilesAdded",j)}});b.bind("Silverlight:UploadChunkError",function(v,m,u,l,t){b.trigger("Error",{code:h.IO_ERROR,message:"IO Error.",details:t,file:v.getFile(k[m])})});b.bind("Silverlight:UploadFileProgress",function(v,l,u,m){var t=v.getFile(k[l]);if(t.status!=h.FAILED){t.size=m;t.loaded=u;v.trigger("UploadProgress",t)}});b.bind("Refresh",function(t){var s,m,l;s=document.getElementById(t.settings.browse_button);m=h.getPos(s,document.getElementById(t.settings.container));l=h.getSize(s);h.extend(document.getElementById(t.id+"_silverlight_container").style,{top:m.y+"px",left:m.x+"px",width:l.w+"px",height:l.h+"px"})});b.bind("Silverlight:UploadChunkSuccessful",function(z,w,y,l,m){var v,x=z.getFile(k[w]);v={chunk:y,chunks:l,response:m};z.trigger("ChunkUploaded",x,v);if(x.status!=h.FAILED){p().UploadNextChunk()}if(y==l-1){x.status=h.DONE;z.trigger("FileUploaded",x,{response:m})}});b.bind("Silverlight:UploadSuccessful",function(t,l,s){var m=t.getFile(k[l]);m.status=h.DONE;t.trigger("FileUploaded",m,{response:s})});b.bind("FilesRemoved",function(r,l){var m;for(m=0;m<l.length;m++){p().RemoveFile(k[l[m].id])}});b.bind("UploadFile",function(t,m){var l=t.settings,s=l.resize||{};p().UploadFile(k[m.id],h.buildUrl(t.settings.url,{name:m.target_name||m.name}),e({chunk_size:l.chunk_size,image_width:s.width,image_height:s.height,image_quality:s.quality||90,multipart:!!l.multipart,multipart_params:l.multipart_params||{},headers:l.headers}))});a({success:true})})}})})(plupload);(function(f){var e={};function d(){var c;try{c=navigator.plugins["Shockwave Flash"];c=c.description}catch(a){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(b){c="0.0"}}c=c.match(/\d+/g);return parseFloat(c[0]+"."+c[1])}f.flash={trigger:function(a,c,b){setTimeout(function(){var i=e[a],k,l;if(i){i.trigger("Flash:"+c,b)}},0)}};f.runtimes.Flash=f.addRuntime("flash",{getFeatures:function(){return{jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(q,b){var c,r,p,s,a=0,t=document.body;if(d()<10){b({success:false});return}e[q.id]=q;c=document.getElementById(q.settings.browse_button);r=document.createElement("div");r.id=q.id+"_flash_container";f.extend(r.style,{position:"absolute",top:"0px",background:q.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});r.className="plupload flash";if(q.settings.container){t=document.getElementById(q.settings.container);t.style.position="relative"}t.appendChild(r);p="id="+escape(q.id);r.innerHTML='<object id="'+q.id+'_flash" width="100%" height="100%" style="outline:0" type="application/x-shockwave-flash" data="'+q.settings.flash_swf_url+'"><param name="movie" value="'+q.settings.flash_swf_url+'" /><param name="flashvars" value="'+p+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';function n(){return document.getElementById(q.id+"_flash")}function o(){if(a++>5000){b({success:false});return}if(!s){setTimeout(o,1)}}o();c=r=null;q.bind("Flash:Init",function(){var g={},h,i=q.settings.resize||{};s=true;n().setFileFilters(q.settings.filters,q.settings.multi_selection);q.bind("UploadFile",function(l,k){var j=l.settings;n().uploadFile(g[k.id],f.buildUrl(j.url,{name:k.target_name||k.name}),{chunk_size:j.chunk_size,width:i.width,height:i.height,quality:i.quality||90,multipart:j.multipart,multipart_params:j.multipart_params,file_data_name:j.file_data_name,format:/\.(jpg|jpeg)$/i.test(k.name)?"jpg":"png",headers:j.headers})});q.bind("Flash:UploadProcess",function(k,l){var j=k.getFile(g[l.id]);if(j.status!=f.FAILED){j.loaded=l.loaded;j.size=l.size;k.trigger("UploadProgress",j)}});q.bind("Flash:UploadChunkComplete",function(m,k){var j,l=m.getFile(g[k.id]);j={chunk:k.chunk,chunks:k.chunks,response:k.text};m.trigger("ChunkUploaded",l,j);if(l.status!=f.FAILED){n().uploadNextChunk()}if(k.chunk==k.chunks-1){l.status=f.DONE;m.trigger("FileUploaded",l,{response:k.text})}});q.bind("Flash:SelectFiles",function(x,l){var m,w,k=[],j;for(w=0;w<l.length;w++){m=l[w];j=f.guid();g[j]=m.id;g[m.id]=j;k.push(new f.File(j,m.name,m.size))}if(k.length){q.trigger("FilesAdded",k)}});q.bind("Flash:SecurityError",function(k,j){q.trigger("Error",{code:f.SECURITY_ERROR,message:"Security error.",details:j.message,file:q.getFile(g[j.id])})});q.bind("Flash:GenericError",function(k,j){q.trigger("Error",{code:f.GENERIC_ERROR,message:"Generic error.",details:j.message,file:q.getFile(g[j.id])})});q.bind("Flash:IOError",function(k,j){q.trigger("Error",{code:f.IO_ERROR,message:"IO error.",details:j.message,file:q.getFile(g[j.id])})});q.bind("QueueChanged",function(j){q.refresh()});q.bind("FilesRemoved",function(l,j){var k;for(k=0;k<j.length;k++){n().removeFile(g[j[k].id])}});q.bind("StateChanged",function(j){q.refresh()});q.bind("Refresh",function(m){var l,k,j;n().setFileFilters(q.settings.filters,q.settings.multi_selection);l=document.getElementById(m.settings.browse_button);k=f.getPos(l,document.getElementById(m.settings.container));j=f.getSize(l);f.extend(document.getElementById(m.id+"_flash_container").style,{top:k.y+"px",left:k.x+"px",width:j.w+"px",height:j.h+"px"})});b({success:true})})}})})(plupload);(function(b){b.runtimes.BrowserPlus=b.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:true,jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(l,j){var n=window.BrowserPlus,k={},o=l.settings,p=o.resize;function m(h){var c,d,f=[],e,g;for(d=0;d<h.length;d++){e=h[d];g=b.guid();k[g]=e;f.push(new b.File(g,e.name,e.size))}if(d){l.trigger("FilesAdded",f)}}function a(){l.bind("PostInit",function(){var c,e=o.drop_element,h=l.id+"_droptarget",f=document.getElementById(e),d;function g(s,t){n.DragAndDrop.AddDropTarget({id:s},function(q){n.DragAndDrop.AttachCallbacks({id:s,hover:function(r){if(!r&&t){t()}},drop:function(r){if(t){t()}m(r)}},function(){})})}function i(){document.getElementById(h).style.top="-1000px"}if(f){if(document.attachEvent&&(/MSIE/gi).test(navigator.userAgent)){c=document.createElement("div");c.setAttribute("id",h);b.extend(c.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0});document.body.appendChild(c);b.addEvent(f,"dragenter",function(u){var v,t;v=document.getElementById(e);t=b.getPos(v);b.extend(document.getElementById(h).style,{top:t.y+"px",left:t.x+"px",width:v.offsetWidth+"px",height:v.offsetHeight+"px"})});g(h,i)}else{g(e)}}b.addEvent(document.getElementById(o.browse_button),"click",function(w){var y=[],A,B,x=o.filters,z;w.preventDefault();for(A=0;A<x.length;A++){z=x[A].extensions.split(",");for(B=0;B<z.length;B++){y.push(b.mimeTypes[z[B]])}}n.FileBrowse.OpenBrowseDialog({mimeTypes:y},function(q){if(q.success){m(q.value)}})});f=c=null});l.bind("UploadFile",function(g,s){var h=k[s.id],t={},i=g.settings.chunk_size,f,e=[];function c(v,q){var r;if(s.status==b.FAILED){return}t.name=s.target_name||s.name;if(i){t.chunk=v;t.chunks=q}r=e.shift();n.Uploader.upload({url:b.buildUrl(g.settings.url,t),files:{file:r},cookies:document.cookies,postvars:g.settings.multipart_params,progressCallback:function(u){var y,z=0;f[v]=parseInt(u.filePercent*r.size/100,10);for(y=0;y<f.length;y++){z+=f[y]}s.loaded=z;g.trigger("UploadProgress",s)}},function(y){var z,u;if(y.success){z=y.value.statusCode;if(i){g.trigger("ChunkUploaded",s,{chunk:v,chunks:q,response:y.value.body,status:z})}if(e.length>0){c(++v,q)}else{s.status=b.DONE;g.trigger("FileUploaded",s,{response:y.value.body,status:z});if(z>=400){g.trigger("Error",{code:b.HTTP_ERROR,message:"HTTP Error.",file:s,status:z})}}}else{g.trigger("Error",{code:b.GENERIC_ERROR,message:"Generic Error.",file:s,details:y.error})}})}function d(q){s.size=q.size;if(i){n.FileAccess.chunk({file:q,chunkSize:i},function(x){if(x.success){var r=x.value,z=r.length;f=Array(z);for(var y=0;y<z;y++){f[y]=0;e.push(r[y])}c(0,z)}})}else{f=Array(1);e.push(q);c(0,1)}}if(p&&/\.(png|jpg|jpeg)$/i.test(s.name)){BrowserPlus.ImageAlter.transform({file:h,quality:p.quality||90,actions:[{scale:{maxwidth:p.width,maxheight:p.height}}]},function(q){if(q.success){d(q.value.file)}})}else{d(h)}});j({success:true})}if(n){n.init(function(c){var d=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];if(p){d.push({service:"ImageAlter",version:"4"})}if(c.success){n.require({services:d},function(e){if(e.success){a()}else{j()}})}else{j()}})}else{j()}}})})(plupload);(function(c){function d(n,a,m,t,b){var r,s,o,p,q;r=document.createElement("canvas");r.style.display="none";document.body.appendChild(r);s=r.getContext("2d");o=new Image();o.onload=function(){var f,e,g;q=Math.min(a/o.width,m/o.height);if(q<1){f=Math.round(o.width*q);e=Math.round(o.height*q)}else{f=o.width;e=o.height}r.width=f;r.height=e;s.drawImage(o,0,0,f,e);p=r.toDataURL(t);p=p.substring(p.indexOf("base64,")+7);p=atob(p);r.parentNode.removeChild(r);b({success:true,data:p})};o.src=n}c.runtimes.Html5=c.addRuntime("html5",{getFeatures:function(){var a,i,b,h,j;i=b=h=j=false;if(window.XMLHttpRequest){a=new XMLHttpRequest();b=!!a.upload;i=!!(a.sendAsBinary||a.upload)}if(i){h=!!(File&&File.prototype.getAsDataURL);j=!!(File&&File.prototype.slice)}return{html5:i,dragdrop:window.mozInnerScreenX!==undefined||j,jpgresize:h,pngresize:h,multipart:h,progress:b}},init:function(b,a){var h={};function g(f){var m,n,i=[],e;for(n=0;n<f.length;n++){m=f[n];e=c.guid();h[e]=m;i.push(new c.File(e,m.fileName,m.fileSize))}if(i.length){b.trigger("FilesAdded",i)}}if(!this.getFeatures().html5){a({success:false});return}b.bind("Init",function(r){var e,i=[],s,f,u=r.settings.filters,t,q,v=document.body;e=document.createElement("div");e.id=r.id+"_html5_container";for(s=0;s<u.length;s++){t=u[s].extensions.split(/,/);for(f=0;f<t.length;f++){q=c.mimeTypes[t[f]];if(q){i.push(q)}}}c.extend(e.style,{position:"absolute",background:b.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:b.settings.shim_bgcolor?"":0});e.className="plupload html5";if(b.settings.container){v=document.getElementById(b.settings.container);v.style.position="relative"}v.appendChild(e);e.innerHTML='<input id="'+b.id+'_html5" style="width:100%;" type="file" accept="'+i.join(",")+'" '+(b.settings.multi_selection?'multiple="multiple"':"")+" />";document.getElementById(b.id+"_html5").onchange=function(){g(this.files);this.value=""}});b.bind("PostInit",function(){var e=document.getElementById(b.settings.drop_element);if(e){c.addEvent(e,"dragover",function(f){f.preventDefault()});c.addEvent(e,"drop",function(f){var j=f.dataTransfer;if(j&&j.files){g(j.files)}f.preventDefault()})}});b.bind("Refresh",function(l){var k,f,e;k=document.getElementById(b.settings.browse_button);f=c.getPos(k,document.getElementById(l.settings.container));e=c.getSize(k);c.extend(document.getElementById(b.id+"_html5_container").style,{top:f.y+"px",left:f.x+"px",width:e.w+"px",height:e.h+"px"})});b.bind("UploadFile",function(s,p){var t=new XMLHttpRequest(),q=t.upload,r=s.settings.resize,e,f=0;function o(m){var i="----pluploadboundary"+c.guid(),k="--",j="\r\n",l="";if(s.settings.multipart){t.setRequestHeader("Content-Type","multipart/form-data; boundary="+i);c.each(s.settings.multipart_params,function(n,v){l+=k+i+j+'Content-Disposition: form-data; name="'+v+'"'+j+j;l+=n+j});l+=k+i+j+'Content-Disposition: form-data; name="'+s.settings.file_data_name+'"; filename="'+p.name+'"'+j+"Content-Type: application/octet-stream"+j+j+m+j+k+i+k+j;f=l.length-m.length;m=l}t.sendAsBinary(m)}if(p.status==c.DONE||p.status==c.FAILED||s.state==c.STOPPED){return}if(q){q.onprogress=function(i){p.loaded=i.loaded-f;s.trigger("UploadProgress",p)}}t.onreadystatechange=function(){var j;if(t.readyState==4){try{j=t.status}catch(i){j=0}p.status=c.DONE;p.loaded=p.size;s.trigger("UploadProgress",p);s.trigger("FileUploaded",p,{response:t.responseText,status:j});if(j>=400){s.trigger("Error",{code:c.HTTP_ERROR,message:"HTTP Error.",file:p,status:j})}}};t.open("post",c.buildUrl(s.settings.url,{name:p.target_name||p.name}),true);t.setRequestHeader("Content-Type","application/octet-stream");c.each(s.settings.headers,function(i,j){t.setRequestHeader(j,i)});e=h[p.id];if(t.sendAsBinary){if(r&&/\.(png|jpg|jpeg)$/i.test(p.name)){d(e.getAsDataURL(),r.width,r.height,/\.png$/i.test(p.name)?"image/png":"image/jpeg",function(i){if(i.success){p.size=i.data.length;o(i.data)}else{o(e.getAsBinary())}})}else{o(e.getAsBinary())}}else{t.send(e)}});a({success:true})}})})(plupload);(function(b){b.runtimes.Html4=b.addRuntime("html4",{getFeatures:function(){return{multipart:true}},init:function(i,h){var k={},l,a;function j(d){var e,f,c=[],o,g;g=d.value.replace(/\\/g,"/");g=g.substring(g.length,g.lastIndexOf("/")+1);o=b.guid();e=new b.File(o,g);k[o]=e;e.input=d;c.push(e);if(c.length){i.trigger("FilesAdded",c)}}i.bind("Init",function(e){var C,D,F,H=[],f,G,y=e.settings.filters,z,I,c=/MSIE/.test(navigator.userAgent),A="javascript",E,B=document.body,g;if(i.settings.container){B=document.getElementById(i.settings.container);B.style.position="relative"}l=(typeof e.settings.form=="string")?document.getElementById(e.settings.form):e.settings.form;if(!l){g=document.getElementById(i.settings.browse_button);for(;g;g=g.parentNode){if(g.nodeName=="FORM"){l=g}}}if(!l){l=document.createElement("form");l.style.display="inline";g=document.getElementById(i.settings.container);g.parentNode.insertBefore(l,g);l.appendChild(g)}l.setAttribute("method","post");l.setAttribute("enctype","multipart/form-data");b.each(e.settings.multipart_params,function(n,o){var m=document.createElement("input");b.extend(m,{type:"hidden",name:o,value:n});l.appendChild(m)});a=document.createElement("iframe");a.setAttribute("src",A+':""');a.setAttribute("name",e.id+"_iframe");a.setAttribute("id",e.id+"_iframe");a.style.display="none";b.addEvent(a,"load",function(r){var p=r.target,o=i.currentfile,m;try{m=p.contentWindow.document||p.contentDocument||window.frames[p.id].document}catch(q){e.trigger("Error",{code:b.SECURITY_ERROR,message:"Security error.",file:o});return}if(m.location.href=="about:blank"||!o){return}var n=m.documentElement.innerText||m.documentElement.textContent;if(n!=""){o.status=b.DONE;o.loaded=1025;o.percent=100;if(o.input){o.input.removeAttribute("name")}e.trigger("UploadProgress",o);e.trigger("FileUploaded",o,{response:n});if(l.tmpAction){l.setAttribute("action",l.tmpAction)}if(l.tmpTarget){l.setAttribute("target",l.tmpTarget)}}});l.appendChild(a);if(c){window.frames[a.id].name=a.name}D=document.createElement("div");D.id=e.id+"_iframe_container";for(f=0;f<y.length;f++){z=y[f].extensions.split(/,/);for(G=0;G<z.length;G++){I=b.mimeTypes[z[G]];if(I){H.push(I)}}}b.extend(D.style,{position:"absolute",background:"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:0});E=i.settings.shim_bgcolor;if(E){b.extend(D.style,{background:E,opacity:1})}D.className="plupload_iframe";B.appendChild(D);function d(){F=document.createElement("input");F.setAttribute("type","file");F.setAttribute("accept",H.join(","));F.setAttribute("size",1);b.extend(F.style,{width:"100%",height:"100%",opacity:0});if(c){b.extend(F.style,{filter:"alpha(opacity=0)"})}b.addEvent(F,"change",function(m){var n=m.target;if(n.value){d();n.style.display="none";j(n)}});D.appendChild(F);return true}d()});i.bind("Refresh",function(f){var e,d,c;e=document.getElementById(i.settings.browse_button);d=b.getPos(e,document.getElementById(f.settings.container));c=b.getSize(e);b.extend(document.getElementById(i.id+"_iframe_container").style,{top:d.y+"px",left:d.x+"px",width:c.w+"px",height:c.h+"px"})});i.bind("UploadFile",function(d,c){if(c.status==b.DONE||c.status==b.FAILED||d.state==b.STOPPED){return}if(!c.input){c.status=b.ERROR;return}c.input.setAttribute("name",d.settings.file_data_name);l.tmpAction=l.getAttribute("action");l.setAttribute("action",b.buildUrl(d.settings.url,{name:c.target_name||c.name}));l.tmpTarget=l.getAttribute("target");l.setAttribute("target",a.name);this.currentfile=c;l.submit()});i.bind("FilesRemoved",function(f,d){var e,c;for(e=0;e<d.length;e++){c=d[e].input;if(c){c.parentNode.removeChild(c)}}});h({success:true})}})})(plupload);$.fn.imagepicker=function(a){var c={insertFn:null};var a=$.extend(c,a);var b=function(h,g){var f=CodeMirrorEditors[0].editor;var j=f.cursorLine(),e=f.cursorPosition(j).character;var i=a.insertFn!=null?a.insertFn(h):h.attr("href");f.insertIntoLine(j,e,i);g.stopPropagation();g.preventDefault();$.fancybox.close()};var d=function(){var e={};e[$("meta[name=csrf-param]").attr("content")]=$("meta[name=csrf-token]").attr("content");var f=new plupload.Uploader({runtimes:(jQuery.browser.webkit==true?"flash":"html5,flash"),container:"theme-images",browse_button:"upload-link",max_file_size:"5mb",url:$("a#upload-link").attr("href"),flash_swf_url:"/javascripts/admin/plugins/plupload/plupload.flash.swf",multipart:true,multipart_params:e});f.bind("QueueChanged",function(){f.start()});f.bind("FileUploaded",function(g,j,h){var i=JSON.parse(h.response);if(i.status=="success"){var k=$(".asset-picker ul li.new-asset").clone().insertBefore($(".asset-picker ul li.clear")).addClass("asset");k.find("strong a").attr("href",i.url).attr("data-local-path",i.local_path).html(i.local_path).bind("click",function(l){b($(this),l)});k.find(".more .size").html(i.size);k.find(".more .date").html(i.date);if($(".asset-picker ul li.asset").length%3==0){k.addClass("last")}k.removeClass("new-asset");$(".asset-picker p.no-items").hide();$(".asset-picker ul").scrollTo($("li.asset:last"),400)}});f.init()};return this.each(function(){$(this).fancybox({onComplete:function(){d();$("ul.theme-assets strong a").bind("click",function(f){b($(this),f)})}})})};